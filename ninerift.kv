<FormLabel@Label>:
    size_hint_x: None
    size: self.texture_size

<FlashScreen@Screen>:
    GridLayout:
        cols: 1
        rows: 3
        GridLayout:
            rows: 2
            size_hint_y: .20
            GridLayout:
                cols: 2
                rows: 2
                size_hint_x: .25
                Spinner:
                    id: fwumodel
                    text:'Model'
                    values: ['esx', 'm365', 'm365pro']
                    sync_height: True
                    font_size: '12sp'
                    height: '14sp'
                    on_text: app.select_model(self.text); app.selfile_filter(self.text, None, fwupart.text)
                Spinner:
                    id: fwupart
                    size_hint_x: .30
                    text: 'Part'
                    values: ['BLE', 'DRV', 'BMS']
                    font_size: '12sp'
                    height: '14sp'
                    sync_height: True
                    on_text: app.fwupd.device = self.text.lower()
                BoxLayout:
                    id: verselhold
                    size_hint_x: .15
                    Spinner:
                        disabled: app.versel in (False,)
                        id: versel
                        text: 'Vers.'
                        font_size: '12sp'
                        height: '14sp'
                        sync_height: True
                        values: ['<141', '>=141']
                        on_text: app.selfile_filter(fwumodel.text, self.text, fwupart.text)
                GridLayout:
                    cols: 2
                    size_hint_x: .25
                    FormLabel:
                        size_hint_x: .2
                        font_size: '12sp'
                        text: "Lock:"
                    Switch:
                        size_hint_x: .8
                        active: True
                        on_active: app.fwupd.lock = self.active
        BoxLayout:
            orientation: 'vertical'
            size_hint_y: .6
            FileChooserListView:
                id: filechooser
                path: app.cache_folder
        GridLayout:
            rows: 2
            size_hint_y: .20
            ProgressBar:
                size_hint_y: .3
            Button:
                size_hint_y: .7
                font_size: '12sp'
                height: '14sp'
                text: "Start"
                on_press: app.fwupd_func(filechooser)

<DownloadScreen@Screen>:
    GridLayout:
        cols: 1
        rows: 3
        AnchorLayout:
            anchor_y: 'top'
            GridLayout:
                cols: 3
                size_hint_y: .25
                Spinner:
                    id: model
                    text: 'Model'
                    values: ['esx', 'm365', 'm365pro']
                    on_text: app.fwget_select_model(root, self.text); app.fwget_update_versions(root)
                    font_size: '12sp'
                    height: '14sp'
                    sync_height: True
                Spinner:
                    id: part
                    text: 'Part'
                    values: ['BLE', 'DRV', 'BMS']
                    on_text: app.fwget_update_versions(root)
                    font_size: '12sp'
                    height: '14sp'
                    sync_height: True
                Spinner:
                    id: version
                    text: 'Version'
                    values: []
                    sync_height: True
                    font_size: '12sp'
                    height: '14sp'
                    text_autoupdate: True
        AnchorLayout:
            size_hint_y: 0.3
            anchor_y: 'bottom'
            Button:
                text: 'Download it!'
                on_press: app.fwget_func(part.text, version.text)

<CommandScreen@Screen>:
    GridLayout:
        cols: 1
        rows: 3
        GridLayout:
            rows: 2
            size_hint_y: .3
            BoxLayout:
                orientation: 'vertical'
                size_hint_y: 0.3
        BoxLayout:
            orientation: 'vertical'
            size_hint_y: .65
        AnchorLayout:
            anchor_y: 'bottom'
            size_hint_y: .10


<MainWindow>:
    orientation: "vertical"
    GridLayout:
        cols: 1
        rows: 5
        GridLayout:
            cols: 1
            size_hint_y: .03
        GridLayout:
            size_hint_y: .12
            disabled: app.conn.state not in ('disconnected',)
            cols: 1
            rows: 4
            BoxLayout:
                orientation: 'horizontal'
                size_hint_y: .25
                FormLabel:
                    font_size: '12sp'
                    text: "Addr:"
                TextInput:
                    multiline: False
                    on_text_validate: app.conn.address = self.text.lower()
                    font_size: '12sp'
                    height: '12sp'
            BoxLayout:
                orientation: 'horizontal'
                size_hint_y: .25
                Spinner:
                    text: 'Interface'
                    values: ['BLE', 'TCP', 'Serial']
                    on_text: app.conn.link = self.text.lower()
                    font_size: '12sp'
                    height: '14sp'
                Spinner:
                    text: 'Protocol'
                    values: ['xiaomi', 'ninebot']
                    on_text: app.conn.transport = self.text.lower()
                    font_size: '12sp'
                    height: '14sp'
            AnchorLayout:
                anchor_y: 'bottom'
                size_hint_y: .30
                Button:
                    text: "Connect" if app.conn.state == 'disconnected' else "Disconnect"
                    disabled: app.conn.state not in ('connected', 'disconnected')
                    on_press: app.connection_toggle()
        GridLayout:
            cols: 1
            size_hint_y: .03
        BoxLayout:
            orientation: 'horizontal'
            size_hint_y: .10
            Button:
                text: "Flash"
                font_size: '12sp'
                height: '14sp'
                on_press: manager.current = 'flash'
            Button:
                text: "Download"
                font_size: '12sp'
                height: '14sp'
                on_press: manager.current = 'download'
            Button:
                text: "Command"
                font_size: '12sp'
                height: '14sp'
                on_press: manager.current = 'command'
        ScreenManager:
            size_hint_y: .72
            id: manager
            FlashScreen:
                name: "flash"
            DownloadScreen:
                name: "download"
            CommandScreen:
                name: "command"
